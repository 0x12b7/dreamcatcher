"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/mod.browser.ts
var mod_browser_exports = {};
__export(mod_browser_exports, {
  EventSignature: () => EventSignature,
  ExternalPureSignature: () => ExternalPureSignature,
  ExternalSignature: () => ExternalSignature,
  ExternalViewSignature: () => ExternalViewSignature,
  Selector: () => Selector,
  Signature: () => Signature,
  SignatureBuilder: () => SignatureBuilder
});
module.exports = __toCommonJS(mod_browser_exports);

// src/vm/signature/event_signature.ts
var EventSignature = (() => {
  {
    return { from };
  }
  function from(selector) {
    return `event ${selector}`;
  }
})();

// src/vm/signature/util/_to_string.ts
function toString(...data) {
  let result = "";
  for (let i = 0n; i < data.length; i++) {
    if (i !== 0n) result = ", ";
    result += data[Number(i)];
  }
  return result;
}

// src/vm/signature/external_pure_signature.ts
var ExternalPureSignature = (() => {
  {
    return { from };
  }
  function from(selector, ...data) {
    return `function ${selector} external pure returns (${toString(...data)})`;
  }
})();

// src/vm/signature/external_signature.ts
var ExternalSignature = (() => {
  {
    return { from };
  }
  function from(selector) {
    return `function ${selector} external`;
  }
})();

// src/vm/signature/external_view_signature.ts
var ExternalViewSignature = (() => {
  {
    return { from };
  }
  function from(selector, ...data) {
    return `function ${selector} external view returns (${toString(...data)})`;
  }
})();

// src/vm/signature/selector.ts
var Selector = (() => {
  {
    return { from };
  }
  function from(name, ...data) {
    return `${name}(${toString(...data)})`;
  }
})();

// src/vm/signature/signature_builder.ts
var import_reliq = require("reliq");
var import_reliq2 = require("reliq");
var import_reliq3 = require("reliq");
var import_reliq4 = require("reliq");
function SignatureBuilder() {
  let _this;
  let _name;
  let _type;
  let _visibility;
  let _payload;
  let _returns;
  {
    _this = {
      name,
      event,
      external,
      pure,
      view,
      payload,
      returns,
      build
    };
    _name = import_reliq2.None;
    _type = import_reliq2.None;
    _visibility = import_reliq2.None;
    _payload = import_reliq2.None;
    _returns = import_reliq2.None;
    return _this;
  }
  function name(name2) {
    _name = (0, import_reliq.Some)(name2);
    return _this;
  }
  function event() {
    _type = (0, import_reliq.Some)("event");
    return _this;
  }
  function external() {
    _type = (0, import_reliq.Some)("external");
    return _this;
  }
  function pure() {
    _visibility = (0, import_reliq.Some)("pure");
    return _this;
  }
  function view() {
    _visibility = (0, import_reliq.Some)("view");
    return _this;
  }
  function payload(...data) {
    _payload = (0, import_reliq.Some)(data);
    return _this;
  }
  function returns(...data) {
    _returns = (0, import_reliq.Some)(data);
    return _this;
  }
  function build() {
    if (_name.none()) return (0, import_reliq4.Err)("SIGNATURE_BUILDER.ERR_MISSING_NAME");
    let name2 = _name.unwrap();
    if (_type.none()) return (0, import_reliq4.Err)("SIGNATURE_BUILDER.ERR_MISSING_TYPE");
    let type = _type.unwrap();
    if (type === "event") {
      let selector = Selector.from(name2, ..._payload.unwrapOr([]));
      let signature = EventSignature.from(selector);
      return (0, import_reliq3.Ok)(signature);
    }
    if (type === "external") {
      let selector = Selector.from(name2, ..._payload.unwrapOr([]));
      if (_visibility.none()) {
        let signature = ExternalSignature.from(selector);
        return (0, import_reliq3.Ok)(signature);
      }
      let visibility = _visibility.unwrap();
      if (visibility === "pure") {
        let signature = ExternalPureSignature.from(selector, ..._returns.unwrapOr([]));
        return (0, import_reliq3.Ok)(signature);
      }
      if (visibility === "view") {
        let signature = ExternalViewSignature.from(selector, ..._returns.unwrapOr([]));
        return (0, import_reliq3.Ok)(signature);
      }
    }
    return (0, import_reliq4.Err)("SIGNATURE_BUILDER.ERR_MALFORMED_SIGNATURE");
  }
}

// src/vm/signature/signature.ts
var import_reliq5 = require("reliq");
var import_reliq6 = require("reliq");
var import_reliq7 = require("reliq");
var Signature = (() => {
  {
    return { nameOf };
  }
  function nameOf(signature) {
    let shards = signature.split(" ");
    if (shards.length === 0) return import_reliq6.None;
    let string = (0, import_reliq7.flag)(shards.at(1));
    if (string.none()) return string;
    let string$0 = string.unwrap();
    let result = (0, import_reliq7.flag)(
      string$0.split("(").at(0)
    );
    if (result.none()) return result;
    let result$0 = result.unwrap();
    return (0, import_reliq5.Some)(result$0);
  }
})();
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  EventSignature,
  ExternalPureSignature,
  ExternalSignature,
  ExternalViewSignature,
  Selector,
  Signature,
  SignatureBuilder
});
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vc3JjL21vZC5icm93c2VyLnRzIiwgIi4uLy4uL3NyYy92bS9zaWduYXR1cmUvZXZlbnRfc2lnbmF0dXJlLnRzIiwgIi4uLy4uL3NyYy92bS9zaWduYXR1cmUvdXRpbC9fdG9fc3RyaW5nLnRzIiwgIi4uLy4uL3NyYy92bS9zaWduYXR1cmUvZXh0ZXJuYWxfcHVyZV9zaWduYXR1cmUudHMiLCAiLi4vLi4vc3JjL3ZtL3NpZ25hdHVyZS9leHRlcm5hbF9zaWduYXR1cmUudHMiLCAiLi4vLi4vc3JjL3ZtL3NpZ25hdHVyZS9leHRlcm5hbF92aWV3X3NpZ25hdHVyZS50cyIsICIuLi8uLi9zcmMvdm0vc2lnbmF0dXJlL3NlbGVjdG9yLnRzIiwgIi4uLy4uL3NyYy92bS9zaWduYXR1cmUvc2lnbmF0dXJlX2J1aWxkZXIudHMiLCAiLi4vLi4vc3JjL3ZtL3NpZ25hdHVyZS9zaWduYXR1cmUudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImV4cG9ydCAqIGZyb20gXCIuL3ZtL2RhdGEvYWRkcmVzc19kYXRhXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL2RhdGEvYXJpdGhtZXRpY19kYXRhX2JpdF9zaXplXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL2RhdGEvYXJpdGhtZXRpY19kYXRhXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL2RhdGEvYXJyYXlfZGF0YVwiO1xyXG5leHBvcnQgKiBmcm9tIFwiLi92bS9kYXRhL2Jvb2xlYW5fZGF0YVwiO1xyXG5leHBvcnQgKiBmcm9tIFwiLi92bS9kYXRhL2J5dGVzX2RhdGFfYml0X3NpemVcIjtcclxuZXhwb3J0ICogZnJvbSBcIi4vdm0vZGF0YS9ieXRlc19kYXRhXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL2RhdGEvZGF0YVwiO1xyXG5leHBvcnQgKiBmcm9tIFwiLi92bS9kYXRhL3N0cmluZ19kYXRhXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL2RhdGEvc3RydWN0X2RhdGFcIjtcclxuZXhwb3J0ICogZnJvbSBcIi4vdm0vc2lnbmF0dXJlL2V2ZW50X3NpZ25hdHVyZV9oYW5kbGVyXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL3NpZ25hdHVyZS9ldmVudF9zaWduYXR1cmVcIjtcclxuZXhwb3J0ICogZnJvbSBcIi4vdm0vc2lnbmF0dXJlL2V4dGVybmFsX3B1cmVfc2lnbmF0dXJlX2hhbmRsZXJcIjtcclxuZXhwb3J0ICogZnJvbSBcIi4vdm0vc2lnbmF0dXJlL2V4dGVybmFsX3B1cmVfc2lnbmF0dXJlXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL3NpZ25hdHVyZS9leHRlcm5hbF9zaWduYXR1cmVfaGFuZGxlclwiO1xyXG5leHBvcnQgKiBmcm9tIFwiLi92bS9zaWduYXR1cmUvZXh0ZXJuYWxfc2lnbmF0dXJlXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL3NpZ25hdHVyZS9leHRlcm5hbF92aWV3X3NpZ25hdHVyZV9oYW5kbGVyXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL3NpZ25hdHVyZS9leHRlcm5hbF92aWV3X3NpZ25hdHVyZVwiO1xyXG5leHBvcnQgKiBmcm9tIFwiLi92bS9zaWduYXR1cmUvbm9uX2FtYmllbnRfc2lnbmF0dXJlXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL3NpZ25hdHVyZS9zZWxlY3Rvcl9oYW5kbGVyXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL3NpZ25hdHVyZS9zZWxlY3RvclwiO1xyXG5leHBvcnQgKiBmcm9tIFwiLi92bS9zaWduYXR1cmUvc2lnbmF0dXJlX2J1aWxkZXJcIjtcclxuZXhwb3J0ICogZnJvbSBcIi4vdm0vc2lnbmF0dXJlL3NpZ25hdHVyZV9oYW5kbGVyXCI7XHJcbmV4cG9ydCAqIGZyb20gXCIuL3ZtL3NpZ25hdHVyZS9zaWduYXR1cmVcIjsiLCAiaW1wb3J0IHR5cGUgeyBFdmVudFNpZ25hdHVyZUhhbmRsZXIgfSBmcm9tIFwiLi9ldmVudF9zaWduYXR1cmVfaGFuZGxlclwiO1xyXG5pbXBvcnQgdHlwZSB7IFNlbGVjdG9yIH0gZnJvbSBcIi4vc2VsZWN0b3JcIjtcclxuXHJcbmV4cG9ydCB0eXBlIEV2ZW50U2lnbmF0dXJlID0gYGV2ZW50ICR7IHN0cmluZyB9KCR7IHN0cmluZyB9KWA7XHJcblxyXG5leHBvcnQgY29uc3QgRXZlbnRTaWduYXR1cmU6IEV2ZW50U2lnbmF0dXJlSGFuZGxlciA9ICgoKSA9PiB7XHJcbiAgICAvKioqLyB7XHJcbiAgICAgICAgcmV0dXJuIHsgZnJvbSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGZyb20oc2VsZWN0b3I6IFNlbGVjdG9yKTogRXZlbnRTaWduYXR1cmUge1xyXG4gICAgICAgIHJldHVybiBgZXZlbnQgJHsgc2VsZWN0b3IgfWA7XHJcbiAgICB9XHJcbn0pKCk7IiwgImltcG9ydCB0eXBlIHsgRGF0YSB9IGZyb20gXCIuLi8uLi9kYXRhL2RhdGFcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0b1N0cmluZyguLi5kYXRhOiBBcnJheTxEYXRhPik6IHN0cmluZyB7XHJcbiAgICBsZXQgcmVzdWx0OiBzdHJpbmcgPSBcIlwiO1xyXG4gICAgZm9yIChsZXQgaTogYmlnaW50ID0gMG47IGkgPCBkYXRhLmxlbmd0aDsgaSArKykge1xyXG4gICAgICAgIGlmIChpICE9PSAwbikgcmVzdWx0ID0gXCIsIFwiO1xyXG4gICAgICAgIHJlc3VsdCArPSBkYXRhW051bWJlcihpKV07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59IiwgImltcG9ydCB0eXBlIHsgRXh0ZXJuYWxQdXJlU2lnbmF0dXJlSGFuZGxlciB9IGZyb20gXCIuL2V4dGVybmFsX3B1cmVfc2lnbmF0dXJlX2hhbmRsZXJcIjsgXHJcbmltcG9ydCB0eXBlIHsgU2VsZWN0b3IgfSBmcm9tIFwiLi9zZWxlY3RvclwiO1xyXG5pbXBvcnQgdHlwZSB7IERhdGEgfSBmcm9tIFwiLi4vZGF0YS9kYXRhXCI7XHJcbmltcG9ydCB7IHRvU3RyaW5nIH0gZnJvbSBcIi4vdXRpbC9fdG9fc3RyaW5nXCI7XHJcblxyXG5leHBvcnQgdHlwZSBFeHRlcm5hbFB1cmVTaWduYXR1cmUgPSBgZnVuY3Rpb24gJHsgc3RyaW5nIH0oJHsgc3RyaW5nIH0pIGV4dGVybmFsIHB1cmUgcmV0dXJucyAoJHsgc3RyaW5nIH0pYDtcclxuXHJcbmV4cG9ydCBjb25zdCBFeHRlcm5hbFB1cmVTaWduYXR1cmU6IEV4dGVybmFsUHVyZVNpZ25hdHVyZUhhbmRsZXIgPSAoKCkgPT4ge1xyXG4gICAgLyoqKi8ge1xyXG4gICAgICAgIHJldHVybiB7IGZyb20gfTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBmcm9tKHNlbGVjdG9yOiBTZWxlY3RvciwgLi4uZGF0YTogQXJyYXk8RGF0YT4pOiBFeHRlcm5hbFB1cmVTaWduYXR1cmUge1xyXG4gICAgICAgIHJldHVybiBgZnVuY3Rpb24gJHsgc2VsZWN0b3IgfSBleHRlcm5hbCBwdXJlIHJldHVybnMgKCR7IHRvU3RyaW5nKC4uLmRhdGEpIH0pYDtcclxuICAgIH1cclxufSkoKTsiLCAiaW1wb3J0IHR5cGUgeyBFeHRlcm5hbFNpZ25hdHVyZUhhbmRsZXIgfSBmcm9tIFwiLi9leHRlcm5hbF9zaWduYXR1cmVfaGFuZGxlclwiO1xyXG5pbXBvcnQgdHlwZSB7IFNlbGVjdG9yIH0gZnJvbSBcIi4vc2VsZWN0b3JcIjtcclxuXHJcbmV4cG9ydCB0eXBlIEV4dGVybmFsU2lnbmF0dXJlID0gYGZ1bmN0aW9uICR7IHN0cmluZyB9KCR7IHN0cmluZyB9KSBleHRlcm5hbGA7XHJcblxyXG5leHBvcnQgY29uc3QgRXh0ZXJuYWxTaWduYXR1cmU6IEV4dGVybmFsU2lnbmF0dXJlSGFuZGxlciA9ICgoKSA9PiB7XHJcbiAgICAvKioqLyB7XHJcbiAgICAgICAgcmV0dXJuIHsgZnJvbSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGZyb20oc2VsZWN0b3I6IFNlbGVjdG9yKTogRXh0ZXJuYWxTaWduYXR1cmUge1xyXG4gICAgICAgIHJldHVybiBgZnVuY3Rpb24gJHsgc2VsZWN0b3IgfSBleHRlcm5hbGA7XHJcbiAgICB9XHJcbn0pKCk7IiwgImltcG9ydCB0eXBlIHsgRXh0ZXJuYWxWaWV3U2lnbmF0dXJlSGFuZGxlciB9IGZyb20gXCIuL2V4dGVybmFsX3ZpZXdfc2lnbmF0dXJlX2hhbmRsZXJcIjtcclxuaW1wb3J0IHR5cGUgeyBTZWxlY3RvciB9IGZyb20gXCIuL3NlbGVjdG9yXCI7XHJcbmltcG9ydCB0eXBlIHsgRGF0YSB9IGZyb20gXCIuLi9kYXRhL2RhdGFcIjtcclxuaW1wb3J0IHsgdG9TdHJpbmcgfSBmcm9tIFwiLi91dGlsL190b19zdHJpbmdcIjtcclxuXHJcbmV4cG9ydCB0eXBlIEV4dGVybmFsVmlld1NpZ25hdHVyZSA9IGBmdW5jdGlvbiAkeyBzdHJpbmcgfSgkeyBzdHJpbmcgfSkgZXh0ZXJuYWwgdmlldyByZXR1cm5zICgkeyBzdHJpbmcgfSlgO1xyXG5cclxuZXhwb3J0IGNvbnN0IEV4dGVybmFsVmlld1NpZ25hdHVyZTogRXh0ZXJuYWxWaWV3U2lnbmF0dXJlSGFuZGxlciA9ICgoKSA9PiB7XHJcbiAgICAvKioqLyB7XHJcbiAgICAgICAgcmV0dXJuIHsgZnJvbSB9O1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGZyb20oc2VsZWN0b3I6IFNlbGVjdG9yLCAuLi5kYXRhOiBBcnJheTxEYXRhPik6IEV4dGVybmFsVmlld1NpZ25hdHVyZSB7XHJcbiAgICAgICAgcmV0dXJuIGBmdW5jdGlvbiAkeyBzZWxlY3RvciB9IGV4dGVybmFsIHZpZXcgcmV0dXJucyAoJHsgdG9TdHJpbmcoLi4uZGF0YSkgfSlgO1xyXG4gICAgfVxyXG59KSgpOyIsICJpbXBvcnQgdHlwZSB7IFNlbGVjdG9ySGFuZGxlciB9IGZyb20gXCIuL3NlbGVjdG9yX2hhbmRsZXJcIjtcclxuaW1wb3J0IHR5cGUgeyBEYXRhIH0gZnJvbSBcIi4uL2RhdGEvZGF0YVwiO1xyXG5pbXBvcnQgeyB0b1N0cmluZyB9IGZyb20gXCIuL3V0aWwvX3RvX3N0cmluZ1wiO1xyXG5cclxuZXhwb3J0IHR5cGUgU2VsZWN0b3IgPSBgJHsgc3RyaW5nIH0oJHsgc3RyaW5nIH0pYDtcclxuXHJcbmV4cG9ydCBjb25zdCBTZWxlY3RvcjogU2VsZWN0b3JIYW5kbGVyID0gKCgpID0+IHtcclxuICAgIC8qKiovIHtcclxuICAgICAgICByZXR1cm4geyBmcm9tIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIGZyb20obmFtZTogc3RyaW5nLCAuLi5kYXRhOiBBcnJheTxEYXRhPik6IFNlbGVjdG9yIHtcclxuICAgICAgICByZXR1cm4gYCR7IG5hbWUgfSgkeyB0b1N0cmluZyguLi5kYXRhKSB9KWA7XHJcbiAgICB9XHJcbn0pKCk7IiwgImltcG9ydCB0eXBlIHsgU2lnbmF0dXJlIH0gZnJvbSBcIi4vc2lnbmF0dXJlXCI7XHJcbmltcG9ydCB0eXBlIHsgRGF0YSB9IGZyb20gXCIuLi9kYXRhL2RhdGFcIjtcclxuaW1wb3J0IHR5cGUgeyBSZXN1bHQgfSBmcm9tIFwicmVsaXFcIjtcclxuaW1wb3J0IHR5cGUgeyBPcHRpb24gfSBmcm9tIFwicmVsaXFcIjtcclxuaW1wb3J0IHsgU2VsZWN0b3IgfSBmcm9tIFwiLi9zZWxlY3RvclwiO1xyXG5pbXBvcnQgeyBFdmVudFNpZ25hdHVyZSB9IGZyb20gXCIuL2V2ZW50X3NpZ25hdHVyZVwiO1xyXG5pbXBvcnQgeyBFeHRlcm5hbFNpZ25hdHVyZSB9IGZyb20gXCIuL2V4dGVybmFsX3NpZ25hdHVyZVwiO1xyXG5pbXBvcnQgeyBFeHRlcm5hbFB1cmVTaWduYXR1cmUgfSBmcm9tIFwiLi9leHRlcm5hbF9wdXJlX3NpZ25hdHVyZVwiO1xyXG5pbXBvcnQgeyBFeHRlcm5hbFZpZXdTaWduYXR1cmUgfSBmcm9tIFwiLi9leHRlcm5hbF92aWV3X3NpZ25hdHVyZVwiO1xyXG5pbXBvcnQgeyBTb21lIH0gZnJvbSBcInJlbGlxXCI7XHJcbmltcG9ydCB7IE5vbmUgfSBmcm9tIFwicmVsaXFcIjtcclxuaW1wb3J0IHsgT2sgfSBmcm9tIFwicmVsaXFcIjtcclxuaW1wb3J0IHsgRXJyIH0gZnJvbSBcInJlbGlxXCI7XHJcblxyXG50eXBlIFJlc3VsdCQwPFQxLCBUMj4gPSBSZXN1bHQ8VDEsIFQyPjtcclxuXHJcbmV4cG9ydCB0eXBlIFNpZ25hdHVyZUJ1aWxkZXIgPSB7XHJcbiAgICBuYW1lKG5hbWU6IHN0cmluZyk6IFNpZ25hdHVyZUJ1aWxkZXI7XHJcbiAgICBldmVudCgpOiBTaWduYXR1cmVCdWlsZGVyO1xyXG4gICAgZXh0ZXJuYWwoKTogU2lnbmF0dXJlQnVpbGRlcjtcclxuICAgIHB1cmUoKTogU2lnbmF0dXJlQnVpbGRlcjtcclxuICAgIHZpZXcoKTogU2lnbmF0dXJlQnVpbGRlcjtcclxuICAgIHBheWxvYWQoLi4uZGF0YTogQXJyYXk8RGF0YT4pOiBTaWduYXR1cmVCdWlsZGVyO1xyXG4gICAgcmV0dXJucyguLi5kYXRhOiBBcnJheTxEYXRhPik6IFNpZ25hdHVyZUJ1aWxkZXI7XHJcbiAgICBidWlsZCgpOiBTaWduYXR1cmVCdWlsZGVyLlJlc3VsdDxTaWduYXR1cmU+O1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIFNpZ25hdHVyZUJ1aWxkZXIoKTogU2lnbmF0dXJlQnVpbGRlciB7XHJcbiAgICBsZXQgX3RoaXM6IFNpZ25hdHVyZUJ1aWxkZXI7XHJcbiAgICBsZXQgX25hbWU6IE9wdGlvbjxzdHJpbmc+O1xyXG4gICAgbGV0IF90eXBlOiBPcHRpb248XCJldmVudFwiIHwgXCJleHRlcm5hbFwiPjtcclxuICAgIGxldCBfdmlzaWJpbGl0eTogT3B0aW9uPFwicHVyZVwiIHwgXCJ2aWV3XCI+O1xyXG4gICAgbGV0IF9wYXlsb2FkOiBPcHRpb248QXJyYXk8RGF0YT4+O1xyXG4gICAgbGV0IF9yZXR1cm5zOiBPcHRpb248QXJyYXk8RGF0YT4+O1xyXG4gICAgXHJcbiAgICAvKioqLyB7XHJcbiAgICAgICAgX3RoaXMgPSB7XHJcbiAgICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICAgIGV2ZW50LFxyXG4gICAgICAgICAgICBleHRlcm5hbCxcclxuICAgICAgICAgICAgcHVyZSxcclxuICAgICAgICAgICAgdmlldyxcclxuICAgICAgICAgICAgcGF5bG9hZCxcclxuICAgICAgICAgICAgcmV0dXJucyxcclxuICAgICAgICAgICAgYnVpbGRcclxuICAgICAgICB9O1xyXG4gICAgICAgIF9uYW1lID0gTm9uZTtcclxuICAgICAgICBfdHlwZSA9IE5vbmU7XHJcbiAgICAgICAgX3Zpc2liaWxpdHkgPSBOb25lO1xyXG4gICAgICAgIF9wYXlsb2FkID0gTm9uZTtcclxuICAgICAgICBfcmV0dXJucyA9IE5vbmU7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG5hbWUobmFtZTogc3RyaW5nKTogU2lnbmF0dXJlQnVpbGRlciB7XHJcbiAgICAgICAgX25hbWUgPSBTb21lKG5hbWUpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBldmVudCgpOiBTaWduYXR1cmVCdWlsZGVyIHtcclxuICAgICAgICBfdHlwZSA9IFNvbWU8XCJldmVudFwiPihcImV2ZW50XCIpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBleHRlcm5hbCgpOiBTaWduYXR1cmVCdWlsZGVyIHtcclxuICAgICAgICBfdHlwZSA9IFNvbWU8XCJleHRlcm5hbFwiPihcImV4dGVybmFsXCIpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwdXJlKCk6IFNpZ25hdHVyZUJ1aWxkZXIge1xyXG4gICAgICAgIF92aXNpYmlsaXR5ID0gU29tZTxcInB1cmVcIj4oXCJwdXJlXCIpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB2aWV3KCk6IFNpZ25hdHVyZUJ1aWxkZXIge1xyXG4gICAgICAgIF92aXNpYmlsaXR5ID0gU29tZTxcInZpZXdcIj4oXCJ2aWV3XCIpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBwYXlsb2FkKC4uLmRhdGE6IEFycmF5PERhdGE+KTogU2lnbmF0dXJlQnVpbGRlciB7XHJcbiAgICAgICAgX3BheWxvYWQgPSBTb21lKGRhdGEpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZXR1cm5zKC4uLmRhdGE6IEFycmF5PERhdGE+KTogU2lnbmF0dXJlQnVpbGRlciB7XHJcbiAgICAgICAgX3JldHVybnMgPSBTb21lKGRhdGEpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBidWlsZCgpOiBTaWduYXR1cmVCdWlsZGVyLlJlc3VsdDxTaWduYXR1cmU+IHtcclxuICAgICAgICBpZiAoX25hbWUubm9uZSgpKSByZXR1cm4gRXJyKFwiU0lHTkFUVVJFX0JVSUxERVIuRVJSX01JU1NJTkdfTkFNRVwiKTtcclxuICAgICAgICBsZXQgbmFtZTogc3RyaW5nID0gX25hbWUudW53cmFwKCk7XHJcbiAgICAgICAgaWYgKF90eXBlLm5vbmUoKSkgcmV0dXJuIEVycihcIlNJR05BVFVSRV9CVUlMREVSLkVSUl9NSVNTSU5HX1RZUEVcIik7XHJcbiAgICAgICAgbGV0IHR5cGU6IFwiZXZlbnRcIiB8IFwiZXh0ZXJuYWxcIiA9IF90eXBlLnVud3JhcCgpO1xyXG4gICAgICAgIGlmICh0eXBlID09PSBcImV2ZW50XCIpIHtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdG9yOiBTZWxlY3RvciA9IFNlbGVjdG9yLmZyb20obmFtZSwgLi4uX3BheWxvYWQudW53cmFwT3IoW10pKTtcclxuICAgICAgICAgICAgbGV0IHNpZ25hdHVyZTogRXZlbnRTaWduYXR1cmUgPSBFdmVudFNpZ25hdHVyZS5mcm9tKHNlbGVjdG9yKTtcclxuICAgICAgICAgICAgcmV0dXJuIE9rKHNpZ25hdHVyZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlID09PSBcImV4dGVybmFsXCIpIHtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdG9yOiBTZWxlY3RvciA9IFNlbGVjdG9yLmZyb20obmFtZSwgLi4uX3BheWxvYWQudW53cmFwT3IoW10pKTtcclxuICAgICAgICAgICAgaWYgKF92aXNpYmlsaXR5Lm5vbmUoKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNpZ25hdHVyZTogRXh0ZXJuYWxTaWduYXR1cmUgPSBFeHRlcm5hbFNpZ25hdHVyZS5mcm9tKHNlbGVjdG9yKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBPayhzaWduYXR1cmUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB2aXNpYmlsaXR5OiBcInB1cmVcIiB8IFwidmlld1wiID0gX3Zpc2liaWxpdHkudW53cmFwKCk7XHJcbiAgICAgICAgICAgIGlmICh2aXNpYmlsaXR5ID09PSBcInB1cmVcIikge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNpZ25hdHVyZTogRXh0ZXJuYWxQdXJlU2lnbmF0dXJlID0gRXh0ZXJuYWxQdXJlU2lnbmF0dXJlLmZyb20oc2VsZWN0b3IsIC4uLl9yZXR1cm5zLnVud3JhcE9yKFtdKSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gT2soc2lnbmF0dXJlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodmlzaWJpbGl0eSA9PT0gXCJ2aWV3XCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBzaWduYXR1cmU6IEV4dGVybmFsVmlld1NpZ25hdHVyZSA9IEV4dGVybmFsVmlld1NpZ25hdHVyZS5mcm9tKHNlbGVjdG9yLCAuLi5fcmV0dXJucy51bndyYXBPcihbXSkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9rKHNpZ25hdHVyZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIEVycihcIlNJR05BVFVSRV9CVUlMREVSLkVSUl9NQUxGT1JNRURfU0lHTkFUVVJFXCIpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgbmFtZXNwYWNlIFNpZ25hdHVyZUJ1aWxkZXIge1xyXG4gICAgZXhwb3J0IHR5cGUgUmVzdWx0PFQxPiA9IFJlc3VsdCQwPFQxLCBFcnJvckNvZGU+O1xyXG5cclxuICAgIGV4cG9ydCB0eXBlIEVycm9yQ29kZSA9XHJcbiAgICAgICAgfCBcIlNJR05BVFVSRV9CVUlMREVSLkVSUl9NSVNTSU5HX05BTUVcIlxyXG4gICAgICAgIHwgXCJTSUdOQVRVUkVfQlVJTERFUi5FUlJfTUlTU0lOR19UWVBFXCJcclxuICAgICAgICB8IFwiU0lHTkFUVVJFX0JVSUxERVIuRVJSX01BTEZPUk1FRF9TSUdOQVRVUkVcIjtcclxufSIsICJpbXBvcnQgdHlwZSB7IEV2ZW50U2lnbmF0dXJlIH0gZnJvbSBcIi4vZXZlbnRfc2lnbmF0dXJlXCI7XHJcbmltcG9ydCB0eXBlIHsgRXh0ZXJuYWxQdXJlU2lnbmF0dXJlIH0gZnJvbSBcIi4vZXh0ZXJuYWxfcHVyZV9zaWduYXR1cmVcIjtcclxuaW1wb3J0IHR5cGUgeyBFeHRlcm5hbFZpZXdTaWduYXR1cmUgfSBmcm9tIFwiLi9leHRlcm5hbF92aWV3X3NpZ25hdHVyZVwiO1xyXG5pbXBvcnQgdHlwZSB7IEV4dGVybmFsU2lnbmF0dXJlIH0gZnJvbSBcIi4vZXh0ZXJuYWxfc2lnbmF0dXJlXCI7XHJcbmltcG9ydCB0eXBlIHsgU2lnbmF0dXJlSGFuZGxlciB9IGZyb20gXCIuL3NpZ25hdHVyZV9oYW5kbGVyXCI7XHJcbmltcG9ydCB0eXBlIHsgT3B0aW9uIH0gZnJvbSBcInJlbGlxXCI7XHJcbmltcG9ydCB7IFNvbWUgfSBmcm9tIFwicmVsaXFcIjtcclxuaW1wb3J0IHsgTm9uZSB9IGZyb20gXCJyZWxpcVwiO1xyXG5pbXBvcnQgeyBmbGFnIH0gZnJvbSBcInJlbGlxXCI7XHJcblxyXG5leHBvcnQgdHlwZSBTaWduYXR1cmUgPVxyXG4gICAgfCBFdmVudFNpZ25hdHVyZVxyXG4gICAgfCBFeHRlcm5hbFB1cmVTaWduYXR1cmVcclxuICAgIHwgRXh0ZXJuYWxWaWV3U2lnbmF0dXJlXHJcbiAgICB8IEV4dGVybmFsU2lnbmF0dXJlO1xyXG5cclxuZXhwb3J0IGNvbnN0IFNpZ25hdHVyZTogU2lnbmF0dXJlSGFuZGxlciA9ICgoKSA9PiB7XHJcbiAgICAvKioqLyB7XHJcbiAgICAgICAgcmV0dXJuIHsgbmFtZU9mIH07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbmFtZU9mKHNpZ25hdHVyZTogU2lnbmF0dXJlKTogT3B0aW9uPHN0cmluZz4ge1xyXG4gICAgICAgIGxldCBzaGFyZHM6IEFycmF5PHN0cmluZz4gPSBzaWduYXR1cmUuc3BsaXQoXCIgXCIpO1xyXG4gICAgICAgIGlmIChzaGFyZHMubGVuZ3RoID09PSAwKSByZXR1cm4gTm9uZTtcclxuICAgICAgICBsZXQgc3RyaW5nOiBPcHRpb248c3RyaW5nPiA9IGZsYWcoc2hhcmRzLmF0KDEpKTtcclxuICAgICAgICBpZiAoc3RyaW5nLm5vbmUoKSkgcmV0dXJuIHN0cmluZztcclxuICAgICAgICBsZXQgc3RyaW5nJDA6IHN0cmluZyA9IHN0cmluZy51bndyYXAoKTtcclxuICAgICAgICBsZXQgcmVzdWx0OiBPcHRpb248c3RyaW5nPiA9IGZsYWcoXHJcbiAgICAgICAgICAgIHN0cmluZyQwXHJcbiAgICAgICAgICAgICAgICAuc3BsaXQoXCIoXCIpXHJcbiAgICAgICAgICAgICAgICAuYXQoMClcclxuICAgICAgICApO1xyXG4gICAgICAgIGlmIChyZXN1bHQubm9uZSgpKSByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIGxldCByZXN1bHQkMDogc3RyaW5nID0gcmVzdWx0LnVud3JhcCgpO1xyXG4gICAgICAgIHJldHVybiBTb21lKHJlc3VsdCQwKTtcclxuICAgIH1cclxufSkoKTsiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFB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SyxFQUFHLFlBQU8sbUJBQUksb0NBQW9DO0FBQ2pFLFFBQUksT0FBNkIsTUFBTSxPQUFPO0FBQzlDLFFBQUksU0FBUyxTQUFTO0FBQ2xCLFVBQUksV0FBcUIsU0FBUyxLQUFLQSxPQUFNLEdBQUcsU0FBUyxTQUFTLENBQUMsQ0FBQyxDQUFDO0FBQ3JFLFVBQUksWUFBNEIsZUFBZSxLQUFLLFFBQVE7QUFDNUQsaUJBQU8sa0JBQUcsU0FBUztBQUFBLElBQ3ZCO0FBQ0EsUUFBSSxTQUFTLFlBQVk7QUFDckIsVUFBSSxXQUFxQixTQUFTLEtBQUtBLE9BQU0sR0FBRyxTQUFTLFNBQVMsQ0FBQyxDQUFDLENBQUM7QUFDckUsVUFBSSxZQUFZLEtBQUssR0FBRztBQUNwQixZQUFJLFlBQStCLGtCQUFrQixLQUFLLFFBQVE7QUFDbEUsbUJBQU8sa0JBQUcsU0FBUztBQUFBLE1BQ3ZCO0FBQ0EsVUFBSSxhQUE4QixZQUFZLE9BQU87QUFDckQsVUFBSSxlQUFlLFFBQVE7QUFDdkIsWUFBSSxZQUFtQyxzQkFBc0IsS0FBSyxVQUFVLEdBQUcsU0FBUyxTQUFTLENBQUMsQ0FBQyxDQUFDO0FBQ3BHLG1CQUFPLGtCQUFHLFNBQVM7QUFBQSxNQUN2QjtBQUNBLFVBQUksZUFBZSxRQUFRO0FBQ3ZCLFlBQUksWUFBbUMsc0JBQXNCLEtBQUssVUFBVSxHQUFHLFNBQVMsU0FBUyxDQUFDLENBQUMsQ0FBQztBQUNwRyxtQkFBTyxrQkFBRyxTQUFTO0FBQUEsTUFDdkI7QUFBQSxJQUNKO0FBQ0EsZUFBTyxtQkFBSSwyQ0FBMkM7QUFBQSxFQUMxRDtBQUNKOzs7QUMvR0EsSUFBQUMsZ0JBQXFCO0FBQ3JCLElBQUFBLGdCQUFxQjtBQUNyQixJQUFBQSxnQkFBcUI7QUFRZCxJQUFNLGFBQStCLE1BQU07QUFDeEM7QUFDRixXQUFPLEVBQUUsT0FBTztBQUFBLEVBQ3BCO0FBRUEsV0FBUyxPQUFPLFdBQXNDO0FBQ2xELFFBQUksU0FBd0IsVUFBVSxNQUFNLEdBQUc7QUFDL0MsUUFBSSxPQUFPLFdBQVcsRUFBRyxRQUFPO0FBQ2hDLFFBQUksYUFBeUIsb0JBQUssT0FBTyxHQUFHLENBQUMsQ0FBQztBQUM5QyxRQUFJLE9BQU8sS0FBSyxFQUFHLFFBQU87QUFDMUIsUUFBSSxXQUFtQixPQUFPLE9BQU87QUFDckMsUUFBSSxhQUF5QjtBQUFBLE1BQ3pCLFNBQ0ssTUFBTSxHQUFHLEVBQ1QsR0FBRyxDQUFDO0FBQUEsSUFDYjtBQUNBLFFBQUksT0FBTyxLQUFLLEVBQUcsUUFBTztBQUMxQixRQUFJLFdBQW1CLE9BQU8sT0FBTztBQUNyQyxlQUFPLG9CQUFLLFFBQVE7QUFBQSxFQUN4QjtBQUNKLEdBQUc7IiwKICAibmFtZXMiOiBbImltcG9ydF9yZWxpcSIsICJuYW1lIiwgImltcG9ydF9yZWxpcSJdCn0K